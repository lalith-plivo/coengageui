---
group: 'changelog'
title: 'Version 4.0.0'
order: 1
slug: /changelog/4-0-0/
release: https://github.com/coengagedev/coengage/releases/tag/4.0.0
date: 'March 10th, 2022'
---

import {
  AspectRatioDemos,
  NumberInputDemos,
  TooltipDemos,
  SliderDemos,
  CheckboxDemos,
  ImageDemos,
  SpotlightDemos,
  OverlayDemos,
  FormDemos,
} from 'coengageui_demos';

## CoengageUI UI

[CoengageUI UI](https://ui.coengage.dev/) is a new project with set of more than 120 responsive components built with CoengageUI.
All components support dark/light color scheme and CoengageUI theme customizations.
CoengageUI UI is free for everyone.

- [CoengageUI UI website](https://ui.coengage.dev/)
- [CoengageUI UI source code](https://github.com/coengagedev/ui.coengage.dev)

## Breaking changes

- `coengageui_core` package no longer exports `CONTAINER_SIZES` variable
- [Prism](https://coengage.dev/others/prism/) now trims code by default, to disable that set `<Prism trim={false} />`
- `useForm` hook exported from `coengageui_hooks` package is now deprecated, it will be removed in one of the next releases.
- [coengageui_eslint-config](https://www.npmjs.com/package/coengageui_eslint-config) was migrated to [eslint-config-mantine](https://www.npmjs.com/package/eslint-config-mantine)

## Renamed props

Some props were renamed to make CoengageUI components more consistent:

- [Dialog](https://coengage.dev/core/dialog/), [Card](https://coengage.dev/core/paper/), [Paper](https://coengage.dev/core/paper/), [Header and Navbar](https://coengage.dev/core/app-shell/)
  - `padding` → `p`
- [Container](https://coengage.dev/core/container/)
  - `padding` → `px`
- [Radio](https://coengage.dev/core/radio-group/)
  - `children` → `label`
- [RadioGroup](https://coengage.dev/core/radio-group/):
  - `variant` → `orientation`
- [Tooltip](https://coengage.dev/core/tooltip):
  - `delay` → `closeDelay`
- [Popover](https://coengage.dev/core/popover/):
  - `noClickOutside` → `closeOnClickOutside`
  - `noFocusTrap` → `trapFocus`
  - `noEscape` → `closeOnEscape`
- [Modal](https://coengage.dev/core/modal/):
  - `noFocusTrap` → `trapFocus`
  - `hideCloseButton` → `withCloseButton`
- [Drawer](https://coengage.dev/core/drawer/):
  - `noFocusTrap` → `trapFocus`
  - `hideCloseButton` → `withCloseButton`
  - `noOverlay` → `withOverlay`
  - `noCloseOnEscape` → `closeOnEscape`
  - `noCloseOnClickOutside` → `closeOnClickOutside`
  - `noScrollLock` → `lockScroll`

## Default props on CoengageUIProvider

Most of components now support default props on CoengageUIProvider:

```tsx
import { CoengageUIProvider, Button } from 'coengageui_core';

function App() {
  return (
    <CoengageUIProvider
      defaultProps={{
        Button: { color: 'red' },
        Badge: { size: 'xl', radius: 0 },
        // ... default props for other components
      }}
    >
      {/* By default, Button will have red color */}
      <Button>Red button</Button>

      {/* Default color can be overwritten by props */}
      <Button color="blue">Blue button</Button>

      {/* By default, Badge will have xl size and 0 radius */}
      <Badge>Badge</Badge>
    </CoengageUIProvider>
  );
}
```

## Styles params on CoengageUIProvider

You can now get component styles params in [CoengageUIProvider](https://coengage.dev/theming/coengageui-provider/) `styles` prop.
Each component that has [Styles API](https://coengage.dev/theming/styles-api/) now exports type that can be assigned to params
`ComponentNameStylesParams`, for example, `ButtonStylesParams`. This feature can be used to add more complex context styles that were not possible before:

```tsx
import { CoengageUIProvider, ButtonStylesParams } from 'coengageui_core';

function Demo() {
  return (
    <CoengageUIProvider
      styles={{
        Button: (theme, params: ButtonStylesParams) => ({
          root: {
            // use params to calculate dynamic styles
            color: theme.colors[params.color || theme.primaryColor][1],
            padding: params.size === 'lg' ? '15px 45px' : undefined,
          },
        }),
      }}
    />
  );
}
```

## Nested CoengageUIProvider inheritance

Nested CoengageUIProviders will now inherit `theme` override, `emotionOptions`, `defaultProps` and `styles` from
parent provider if `inherit` prop is set:

```tsx
import { CoengageUIProvider, Button } from 'coengageui_core';

function App() {
  return (
    // Parent CoengageUIProvider
    <CoengageUIProvider
      theme={{ colorScheme: 'dark' }}
      styles={{ Button: { root: { fontWeight: 400 } } }}
      defaultProps={{ Badge: { variant: 'outline' } }}
      emotionOptions={{ key: 'custom-cache' }}
    >
      <Button>Affected only by parent provider</Button>

      {/*
        Child CoengageUIProvider, inherits theme, emotionOptions, defaultProps and styles
        from parent CoengageUIProvider. Other properties specified on child provider will override parent props.
        For example, theme override will be: { colorScheme: 'dark', primaryColor: 'red' }
      */}
      <CoengageUIProvider theme={{ primaryColor: 'red' }} inherit>
        <Button>Affected only by child provider</Button>
      </CoengageUIProvider>
    </CoengageUIProvider>
  );
}
```

## Default radius and focus ring configuration on theme

CoengageUI theme now includes two new properties: `defaultRadius` and `focusRing`.

`defaultRadius` property is used to set border-radius on most components by default:

```tsx
import { CoengageUIProvider, Button } from 'coengageui_core';

function App() {
  return (
    <CoengageUIProvider theme={{ defaultRadius: 0 }}>
      <Button>Zero radius button</Button>
      <Button radius="xl">xl radius button</Button>
    </CoengageUIProvider>
  );
}
```

With `focusRing` property you can configure how focus ring is displayed:

- `auto` – display focus ring only when user navigates with keyboard (default)
- `always` – display focus ring when user navigates with keyboard and mouse
- `never` – focus ring is always hidden (not recommended)

```tsx
import { CoengageUIProvider, Button } from 'coengageui_core';

function App() {
  return (
    <CoengageUIProvider theme={{ focusRing: 'always' }}>
      <Button>Focus ring will be displayed when user clicks the button</Button>
    </CoengageUIProvider>
  );
}
```

## Padding props

All components now support setting following props to control padding:

- `p` – sets `padding` property on root element
- `py` – sets `padding-top` and `padding-bottom` properties on root element
- `px` – sets `padding-right` and `padding-left` properties on root element
- `pt` – sets `padding-top` property on root element
- `pb` – sets `padding-bottom` property on root element
- `pl` – sets `padding-left` property on root element
- `pr` – sets `padding-right` property on root element

```tsx
import { Paper, Container } from 'coengageui_core';

function Demo() {
  return (
    <>
      <Paper p={20} />
      <Container px="xl" />
    </>
  );
}
```

## createStyles references changes

[createStyles](https://coengage.dev/theming/create-styles/) function now works differently with references.
Instead of generating unique identifiers with each `getRef` call it returns the same value for given argument:

```tsx
// before 4.0.0
// getRef('icon') !== getRef('icon')
createStyles((theme, params, getRef) => {
  const icon = getRef('icon');
  return {
    icon: { ref: icon },
    parent: {
      [`& .${icon}`]: { color: 'red' },
    },
  };
});

// in 4.0.0
// getRef('icon') === getRef('icon')
createStyles((theme, params, getRef) => ({
  icon: { ref: getRef('icon') },
  parent: {
    [`& .${getRef('icon')}`]: { color: 'red' },
  },
}));
```

## coengageui_form package

New [coengageui_form package](https://coengage.dev/form/use-form/) is an enhanced version of `useForm` hook that was previously exported from
`coengageui_hooks` package. `coengageui_form` introduces the following features:

- Improved fields validation logic
- Schema based validation with zod, yup or joi
- Array fields support

<Demo data={FormDemos.usage} />

## coengageui_spotlight package

[coengageui_spotlight](https://coengage.dev/others/spotlight/) is a new package that lets you create
a command center for you application. It can be triggered with keyboard shortcut and programmatically
from anywhere in you application:

<Demo data={SpotlightDemos.usage} />

## New components

### AspectRatio

New [AspectRatio](https://coengage.dev/core/aspect-ratio/) component

<Demo data={AspectRatioDemos.video} />

### CheckboxGroup

New [CheckboxGroup](https://coengage.dev/core/checkbox/#checkboxgroup) component

<Demo data={CheckboxDemos.groupConfigurator} />

### BackgroundImage

New [BackgroundImage](https://coengage.dev/core/image/#backgroundimage-component) component

<Demo data={ImageDemos.background} />

## New features

[NumberInput](https://coengage.dev/core/number-input/) component now supports `formatter` and `parser` props to customize how value is displayed in the input:

<Demo data={NumberInputDemos.formatter} />

[Tooltip](https://coengage.dev/core/tooltip/) component now supports `openDelay`:

<Demo data={TooltipDemos.delay} />

[Slider and RangeSlider](https://coengage.dev/core/slider/) components now support `onChangeEnd` prop:

<Demo data={SliderDemos.changeEnd} />

[Overlay](https://coengage.dev/core/overlay/) component now supports `blur`:

<Demo data={OverlayDemos.blur} />

## Other changes

- New [use-disclosure](https://coengage.dev/hooks/use-disclosure/) hook
- [Text](https://coengage.dev/core/text/) component now inherits color from parent element
- [Input](https://coengage.dev/core/input/) component now handles `required` prop differently to support native browser validation
- [RichTextEditor](https://coengage.dev/others/rte/) now supports providing extra quill modules via `modules` prop
- [DateRangePicker](https://coengage.dev/dates/date-picker/) now displays first selected date
- [RangeCalendar](https://coengage.dev/dates/calendar/) now calls onChange with first selected date
- [SegmentedControl](https://coengage.dev/core/segmented-control/) component now supports vertical orientation and disabled state
- [ThemeIcon](https://coengage.dev/core/theme-icon/) component now supports outline variant
- [Text](https://coengage.dev/core/text/), [Anchor](https://coengage.dev/core/anchor/) and [Highlight](https://coengage.dev/core/highlight/) components now support `underline` prop
- [Container](https://coengage.dev/core/container/) component now supports sizes configuration with default props on CoengageUIProvider
- All components now support negative margins for theme values with margin props (`m`, `mx`, `my`, `mt`, etc.): `<Button mx="-xl">Negative margins</Button>`
- `onCancel` callback in [coengageui_modals](https://coengage.dev/others/modals/) is now also called when confirm modal is closed without confirmation
- New [OptionalPortal](https://coengage.dev/core/portal/#optionalportal-component) component can be used to switch between rendering within Portal or as a regular child with `withinPortal` prop
- [Modal](https://coengage.dev/core/modal/) and [Drawer](https://coengage.dev/core/drawer/) can now be used without [Portal](https://coengage.dev/core/portal/)
- [Title](https://coengage.dev/core/title/) component now inherits color from parent element

## 3.6.0 – 4.0.0 bug fixes

- Fix incorrect white space handling in [Progress](https://coengage.dev/core/progress/) component with labels
- Fix incorrect transform prop type in [Text](https://coengage.dev/core/text/) and associated components
- Add missing ref type in [Navbar](https://coengage.dev/core/app-shell/) component
- Hidden inputs were removed from [Select](https://coengage.dev/core/select/) and [MultiSelect](https://coengage.dev/core/multi-select/) components to prevent issues with popular form libraries
- Fix incorrect am/pm input handling in [TimeInput](https://coengage.dev/dates/time-input/) for non qwerty keyboards
- Fix incorrect initial value in [use-hash](https://coengage.dev/hooks/use-hash/) hook
- Fix incorrect events handling in [use-hotkeys](https://coengage.dev/hooks/use-hotkeys/) hook for input, textarea and select elements
- [Improve TypeScript performance](https://github.com/coengagedev/coengage/issues/812) for polymorphic components (~ 2x increase in compilation time)
- Fix incorrect [RichTextEditor](https://coengage.dev/others/rte/) white space handling in Firefox
- Add additional filtering to [Group](https://coengage.dev/core/group/) and [MediaQuery](https://coengage.dev/core/media-query/) children to avoid error when components are used with elements that do not support props (numbers, string, fragments)
- Fix incorrect modal size for multiple months in [DatePicker](https://coengage.dev/dates/date-picker/) and [DateRangePicker](https://coengage.dev/dates/date-picker/) components
- Add missing right and bottom padding to [AppShell](https://coengage.dev/core/app-shell/) component
- Fix `initialLevel` prop not working in [DateRangePicker](https://coengage.dev/dates/date-picker/) component
- Add correct input mode to [NumberInput](https://coengage.dev/core/number-input/) – mobile devices will display correct keyboard now
- Fix `findDomNode` warning in [coengageui_notifications](https://coengage.dev/others/notifications/) while using strict react mode
